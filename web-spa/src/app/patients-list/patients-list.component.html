<div class="row">
  <div class="col-xl-8 col-xxl-4">
    <h3 class="text-center mt-3">List Patients</h3>
    <div class="d-flex justify-content-end">
      <button
        type="button"
        class="btn btn-primary"
        data-bs-toggle="modal"
        data-bs-target="#exampleModal"
        data-bs-whatever="@mdo"
      >
        Add Patient
      </button>
    </div>
    <div
      class="modal fade"
      id="exampleModal"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title" id="exampleModalLabel">Add a Patient</h1>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form [formGroup]="addPatient" (ngSubmit)="onSubmit()">
              <div class="form-floating mb-3">
                <input
                  type="text"
                  formControlName="lastName"
                  class="form-control"
                  onkeydown="return /[a-z, ,-]/i.test(event.key)"
                  id="lastName"
                />
                <label for="lastName" class="col-form-label">LastName</label>
              </div>
              <div class="form-floating mb-3">
                <input
                  type="text"
                  formControlName="fatherInitial"
                  class="form-control"
                  id="father-initial"
                  style="text-transform: uppercase"
                  maxlength="3"
                  onkeydown="return /[A-Z]/i.test(event.key)"
                />
                <label for="father-initial" class="col-form-label"
                  >Father Initial</label
                >
              </div>
              <div class="form-floating mb-3">
                <input
                  type="text"
                  formControlName="firstName"
                  onkeydown="return /[a-z, ,-]/i.test(event.key)"
                  class="form-control"
                  id="firstName"
                />
                <label for="firstName" class="col-form-label">FirstName</label>
              </div>
              <div class="form-floating mb-3">
                <input
                  type="text"
                  formControlName="birthday"
                  class="form-control"
                  id="birthday"
                />
                <label for="birthday" class="col-form-label">Birthday</label>
              </div>
              <div class="form-floating mb-3">
                <input
                  type="number"
                  formControlName="phoneNumber"
                  class="form-control"
                  onKeyPress="if(this.value.length==10) return false; "
                  id="phone-number"
                />
                <label for="phone-number" class="col-form-label"
                  >Phone Number</label
                >
              </div>
              <div formGroupName="address">
                <div class="row">
                  <div class="col-md-4">
                    <div class="form-floating mb-3">
                      <input
                        type="text"
                        onkeydown="return /[a-z, ,-,.]/i.test(event.key)"
                        formControlName="street"
                        class="form-control"
                        id="street"
                      />
                      <label for="street" class="col-form-label"
                        >Address Street</label
                      >
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="form-floating mb-3">
                      <input
                        type="number"
                        formControlName="numberStreet"
                        class="form-control"
                        id="numberStreet"
                      />
                      <label for="numberStreet" class="col-form-label"
                        >Number of Street</label
                      >
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="form-floating mb-3">
                      <input
                        type="text"
                        formControlName="building"
                        class="form-control"
                        id="building"
                      />
                      <label for="building" class="col-form-label"
                        >Building</label
                      >
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-floating mb-3">
                      <input
                        type="number"
                        formControlName="floor"
                        class="form-control"
                        id="floor"
                        onKeyPress="if(this.value.length==2) return false;"
                      />
                      <label for="floor" class="col-form-label">Floor</label>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-floating mb-3">
                      <input
                        type="number"
                        onKeyPress="if(this.value.length==4) return false;"
                        formControlName="apartment"
                        class="form-control"
                        id="apartment"
                      />
                      <label for="apartment" class="col-form-label"
                        >Apartment</label
                      >
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-floating mb-3">
                      <input
                        type="text"
                        formControlName="county"
                        class="form-control"
                        id="county"
                      />
                      <label for="county" class="col-form-label">County</label>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-floating mb-3">
                      <input
                        type="text"
                        formControlName="city"
                        class="form-control"
                        id="city"
                        onkeydown="return /[a-z, ,-]/i.test(event.key)"
                      />
                      <label for="city" class="col-form-label">City</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-floating mb-3">
                <input
                  type="number"
                  onKeyPress="if(this.value.length==3) return false;"
                  formControlName="age"
                  class="form-control"
                  id="age"
                />
                <label for="age" class="col-form-label">Age</label>
              </div>
              <div class="form-floating mb-3">
                <input
                  type="text"
                  maxlength="1"
                  onkeyup="this.value = this.value.replace(/[^F/M]/, '')"
                  formControlName="gender"
                  class="form-control"
                  id="gender"
                />
                <label for="gender" class="col-form-label"
                  >Gender: F or M</label
                >
                <span
                  class="help-block text-danger"
                  *ngIf="
                    !addPatient.get('gender').valid &&
                    addPatient.get('gender').touched
                  "
                >
                  Please complete this field!!
                </span>
              </div>
              <div class="form-floating mb-3">
                <input
                  type="text"
                  formControlName="cnp"
                  maxlength="13"
                  class="form-control"
                  id="cnp"
                />
                <label for="cnp" class="col-form-label">CNP</label>
              </div>
              <div class="form-floating mb-3">
                <textarea
                  class="form-control"
                  formControlName="message"
                  id="message-text"
                ></textarea>
                <label for="message-text" class="col-form-label"
                  >Message:</label
                >
              </div>
              <div class="modal-footer">
                <button
                  type="button"
                  class="btn btn-secondary"
                  data-bs-dismiss="modal"
                >
                  Close
                </button>
                <button
                  type="submit"
                  class="btn btn-primary"
                  data-bs-dismiss="modal"
                  [disabled]="addPatient.get('gender').invalid"
                >
                  Send message
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <div class="form-floating my-3">
      <input
        type="text"
        class="form-control"
        id="floatingInput"
        placeholder="search"
        [(ngModel)]="listFilter"
      />
      <label for="floatingInput">Search</label>
    </div>

    <div class="card mb-3" *ngFor="let patient of filteredPatients">
      <div class="card-body">
        <h5 class="card-title text-center">The Pacient {{ patient.id }}</h5>
        <h6 class="card-subtitle mb-2 text-body-secondary text-center">
          {{ patient.lastName }} {{ patient.firstName }}
        </h6>
        <div class="d-flex justify-content-evenly">
          <p class="card-text"><strong>Age:</strong> {{ patient.age }}</p>
          <p class="card-text"><strong>Gender:</strong> {{ patient.gender }}</p>
        </div>
        <div class="d-flex justify-content-center">
          <button class="btn btn-success me-3">
            <i
              class="fa fa-pencil"
              aria-hidden="true"
              (click)="getDetails(patient.id)"
            ></i>
          </button>
          <button class="btn btn-danger me-3" (click)="delete(patient.id)">
            <i class="fa fa-trash-o" aria-hidden="true"></i>
          </button>
          <button
            class="btn btn-primary"
            data-bs-toggle="modal"
            data-bs-target="#exampleModal1"
            data-bs-whatever="1@mdo"
          >
            <i class="fa fa-qrcode"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
  <div class="col-xl-4 col-xxl-8">
    <app-patients-details
      [patientDetail]="patientDetail"
      [patients]="patients"
    ></app-patients-details>
  </div>
</div>
<div
  class="modal fade"
  id="exampleModal1"
  data-bs-backdrop="static"
  data-bs-keyboard="false"
  tabindex="-1"
  aria-labelledby="exampleModal1"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModal1">QR CODE</h1>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body d-flex justify-content-center">
        <qrcode
          [qrdata]="
            'https://example.com/02B859FE-6919-4D97-9779-303AADA1F82E|12345|MASCULIN'
          "
          [width]="256"
          [errorCorrectionLevel]="'M'"
        ></qrcode>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Close
        </button>
      </div>
    </div>
  </div>
</div>
